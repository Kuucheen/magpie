"use strict";(globalThis.webpackChunkwebsite_docs=globalThis.webpackChunkwebsite_docs||[]).push([[803],{6974(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"reference/architecture","title":"Architecture","description":"Magpie is a multi-component system:","source":"@site/docs/reference/architecture.md","sourceDirName":"reference","slug":"/reference/architecture","permalink":"/docs/reference/architecture","draft":false,"unlisted":false,"editUrl":"https://github.com/Kuucheen/magpie/tree/master/website/docs/docs/reference/architecture.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Admin Settings","permalink":"/docs/user-guide/admin"},"next":{"title":"Configuration","permalink":"/docs/reference/configuration"}}');var s=t(4848),i=t(8453);const o={},c="Architecture",l={},d=[{value:"Startup flow",id:"startup-flow",level:2},{value:"API style",id:"api-style",level:2},{value:"Storage model",id:"storage-model",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"architecture",children:"Architecture"})}),"\n",(0,s.jsx)(n.p,{children:"Magpie is a multi-component system:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["API server (",(0,s.jsx)(n.code,{children:"backend/internal/app/server"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["background job routines (",(0,s.jsx)(n.code,{children:"backend/internal/jobs/*"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["rotating proxy listener manager (",(0,s.jsx)(n.code,{children:"backend/internal/rotatingproxy"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["Angular frontend (",(0,s.jsx)(n.code,{children:"frontend/src/app"}),")"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"startup-flow",children:"Startup flow"}),"\n",(0,s.jsx)(n.p,{children:"At startup, backend:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Loads settings from ",(0,s.jsx)(n.code,{children:"data/settings.json"})," (or embedded defaults)"]}),"\n",(0,s.jsx)(n.li,{children:"Connects Redis and Postgres"}),"\n",(0,s.jsx)(n.li,{children:"Initializes blacklist and optional redis sync hooks"}),"\n",(0,s.jsx)(n.li,{children:"Loads existing proxies/sites into queues"}),"\n",(0,s.jsx)(n.li,{children:"Starts rotating proxy listeners"}),"\n",(0,s.jsx)(n.li,{children:"Starts periodic job routines"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"api-style",children:"API style"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["REST endpoints mounted under ",(0,s.jsx)(n.code,{children:"/api"})]}),"\n",(0,s.jsxs)(n.li,{children:["GraphQL endpoint mounted at ",(0,s.jsx)(n.code,{children:"/api/graphql"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"storage-model",children:"Storage model"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"PostgreSQL stores users, proxies, statistics, reputations, sites, rotators"}),"\n",(0,s.jsx)(n.li,{children:"Redis provides queue/coordinator features used by runtime routines"}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},8453(e,n,t){t.d(n,{R:()=>o,x:()=>c});var r=t(6540);const s={},i=r.createContext(s);function o(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);