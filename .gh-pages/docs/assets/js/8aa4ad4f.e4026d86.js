"use strict";(globalThis.webpackChunkwebsite_docs=globalThis.webpackChunkwebsite_docs||[]).push([[628],{5655(e,s,n){n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>d,default:()=>p,frontMatter:()=>t,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"api/rest-auth-and-user","title":"REST: Auth and User","description":"POST /api/register","source":"@site/docs/api/rest-auth-and-user.md","sourceDirName":"api","slug":"/api/rest-auth-and-user","permalink":"/docs/api/rest-auth-and-user","draft":false,"unlisted":false,"editUrl":"https://github.com/Kuucheen/magpie/tree/master/website/docs/docs/api/rest-auth-and-user.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"REST API Overview","permalink":"/docs/api/rest-overview"},"next":{"title":"REST: Proxies","permalink":"/docs/api/rest-proxies"}}');var i=n(4848),c=n(8453);const t={},d="REST: Auth and User",o={},a=[{value:"<code>POST /api/register</code>",id:"post-apiregister",level:2},{value:"<code>POST /api/login</code>",id:"post-apilogin",level:2},{value:"<code>GET /api/checkLogin</code>",id:"get-apichecklogin",level:2},{value:"<code>POST /api/changePassword</code>",id:"post-apichangepassword",level:2},{value:"<code>POST /api/deleteAccount</code>",id:"post-apideleteaccount",level:2},{value:"<code>GET /api/user/settings</code>",id:"get-apiusersettings",level:2},{value:"<code>POST /api/user/settings</code>",id:"post-apiusersettings",level:2},{value:"<code>GET /api/user/role</code>",id:"get-apiuserrole",level:2},{value:"<code>POST /api/user/export</code>",id:"post-apiuserexport",level:2}];function l(e){const s={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"rest-auth-and-user",children:"REST: Auth and User"})}),"\n",(0,i.jsx)(s.h2,{id:"post-apiregister",children:(0,i.jsx)(s.code,{children:"POST /api/register"})}),"\n",(0,i.jsx)(s.p,{children:"Registers a new user."}),"\n",(0,i.jsx)(s.p,{children:"Request:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "email": "admin@example.com",\n  "password": "change-me-now"\n}\n'})}),"\n",(0,i.jsx)(s.p,{children:"Behavior:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Validates email format."}),"\n",(0,i.jsx)(s.li,{children:"Requires password length >= 8."}),"\n",(0,i.jsxs)(s.li,{children:["First user in DB becomes ",(0,i.jsx)(s.code,{children:"admin"}),"; later users become ",(0,i.jsx)(s.code,{children:"user"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["Success (",(0,i.jsx)(s.code,{children:"201"}),"):"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "token": "<jwt>"\n}\n'})}),"\n",(0,i.jsx)(s.h2,{id:"post-apilogin",children:(0,i.jsx)(s.code,{children:"POST /api/login"})}),"\n",(0,i.jsx)(s.p,{children:"Request:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "email": "admin@example.com",\n  "password": "change-me-now"\n}\n'})}),"\n",(0,i.jsxs)(s.p,{children:["Success (",(0,i.jsx)(s.code,{children:"200"}),"):"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "token": "<jwt>",\n  "role": "admin"\n}\n'})}),"\n",(0,i.jsx)(s.h2,{id:"get-apichecklogin",children:(0,i.jsx)(s.code,{children:"GET /api/checkLogin"})}),"\n",(0,i.jsxs)(s.p,{children:["Requires auth. Returns ",(0,i.jsx)(s.code,{children:"200"})," if token is valid."]}),"\n",(0,i.jsx)(s.h2,{id:"post-apichangepassword",children:(0,i.jsx)(s.code,{children:"POST /api/changePassword"})}),"\n",(0,i.jsx)(s.p,{children:"Requires auth."}),"\n",(0,i.jsx)(s.p,{children:"Request:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "oldPassword": "old-value",\n  "newPassword": "new-value"\n}\n'})}),"\n",(0,i.jsxs)(s.p,{children:["Success returns a JSON string body: ",(0,i.jsx)(s.code,{children:'"Password changed successfully"'}),"."]}),"\n",(0,i.jsx)(s.h2,{id:"post-apideleteaccount",children:(0,i.jsx)(s.code,{children:"POST /api/deleteAccount"})}),"\n",(0,i.jsx)(s.p,{children:"Requires auth."}),"\n",(0,i.jsx)(s.p,{children:"Request:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "password": "current-password"\n}\n'})}),"\n",(0,i.jsxs)(s.p,{children:["Success returns a JSON string body: ",(0,i.jsx)(s.code,{children:'"Account deleted successfully"'}),"."]}),"\n",(0,i.jsx)(s.h2,{id:"get-apiusersettings",children:(0,i.jsx)(s.code,{children:"GET /api/user/settings"})}),"\n",(0,i.jsx)(s.p,{children:"Requires auth. Returns user checker/scraper settings."}),"\n",(0,i.jsx)(s.p,{children:"Response shape:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "http_protocol": true,\n  "https_protocol": true,\n  "socks4_protocol": false,\n  "socks5_protocol": false,\n  "timeout": 7500,\n  "retries": 2,\n  "UseHttpsForSocks": true,\n  "transport_protocol": "tcp",\n  "auto_remove_failing_proxies": false,\n  "auto_remove_failure_threshold": 3,\n  "judges": [{"url": "https://example/judge", "regex": "..."}],\n  "scraping_sources": ["https://example/source"]\n}\n'})}),"\n",(0,i.jsx)(s.h2,{id:"post-apiusersettings",children:(0,i.jsx)(s.code,{children:"POST /api/user/settings"})}),"\n",(0,i.jsx)(s.p,{children:"Requires auth. Saves user protocol/checker settings and judges."}),"\n",(0,i.jsxs)(s.p,{children:["Request uses the same fields as ",(0,i.jsx)(s.code,{children:"GET /api/user/settings"}),"."]}),"\n",(0,i.jsxs)(s.p,{children:["Success (",(0,i.jsx)(s.code,{children:"200"}),"):"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{"message": "Settings saved successfully"}\n'})}),"\n",(0,i.jsx)(s.p,{children:"Current implementation note:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"scraping_sources"})," is returned by this endpoint family but is not persisted by ",(0,i.jsx)(s.code,{children:"POST /api/user/settings"})," in current backend code."]}),"\n",(0,i.jsxs)(s.li,{children:["Use ",(0,i.jsx)(s.code,{children:"POST /api/scrapingSources"})," and ",(0,i.jsx)(s.code,{children:"DELETE /api/scrapingSources"})," to manage scrape sources."]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"get-apiuserrole",children:(0,i.jsx)(s.code,{children:"GET /api/user/role"})}),"\n",(0,i.jsx)(s.p,{children:"Requires auth."}),"\n",(0,i.jsxs)(s.p,{children:["Response body is a JSON string: ",(0,i.jsx)(s.code,{children:'"admin"'})," or ",(0,i.jsx)(s.code,{children:'"user"'}),"."]}),"\n",(0,i.jsx)(s.h2,{id:"post-apiuserexport",children:(0,i.jsx)(s.code,{children:"POST /api/user/export"})}),"\n",(0,i.jsx)(s.p,{children:"Requires auth. Exports proxies by selected IDs and/or filters."}),"\n",(0,i.jsx)(s.p,{children:"Request:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "proxies": [101, 102],\n  "filter": true,\n  "http": true,\n  "https": true,\n  "socks4": false,\n  "socks5": false,\n  "maxRetries": 2,\n  "maxTimeout": 5000,\n  "proxyStatus": "alive",\n  "reputationLabels": ["good", "neutral"],\n  "outputFormat": "ip:port"\n}\n'})}),"\n",(0,i.jsx)(s.p,{children:"Response:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"Content-Type: text/plain"})}),"\n",(0,i.jsx)(s.li,{children:"Body contains the formatted export content."}),"\n"]})]})}function p(e={}){const{wrapper:s}={...(0,c.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8453(e,s,n){n.d(s,{R:()=>t,x:()=>d});var r=n(6540);const i={},c=r.createContext(i);function t(e){const s=r.useContext(c);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),r.createElement(c.Provider,{value:s},e.children)}}}]);