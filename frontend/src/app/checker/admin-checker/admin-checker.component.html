<div class="content-container">
  <form [formGroup]="settingsForm">
    <p-tabs value="0">
      <p-tablist>
        <p-tab value="0">Common</p-tab>
        <p-tab value="1">Judges</p-tab>
        <p-tab value="2">IP</p-tab>
        <p-tab value="3">Blacklist</p-tab>
      </p-tablist>

      <p-tabpanels>
        <!-- Common Tab -->
        <p-tabpanel value="0">
          <h3 class="text-center subText mb-4 mt-0">Protocols</h3>
          <div class="flex justify-center flex-wrap gap-6 mb-3" formGroupName="protocols">
            <app-checkbox label="HTTP" formControlName="http"></app-checkbox>
            <app-checkbox label="HTTPS" formControlName="https"></app-checkbox>
            <app-checkbox label="SOCKS4" formControlName="socks4"></app-checkbox>
            <app-checkbox label="SOCKS5" formControlName="socks5"></app-checkbox>
          </div>

          <p-divider></p-divider>

          <h4 class="text-center subText">Check ALL proxies every</h4>
          <div class="flex justify-center gap-4 flex-wrap text-center mt-4" formGroupName="checker_timer">
            <div class="flex flex-col">
              <label class="text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">Days</label>
              <p-select
                [options]="daysList"
                formControlName="days"
                placeholder="Select Days"
                optionLabel="label"
                optionValue="value"
                class="w-32">
              </p-select>
            </div>
            <div class="flex flex-col">
              <label class="text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">Hours</label>
              <p-select
                [options]="hoursList"
                formControlName="hours"
                placeholder="Select Hours"
                optionLabel="label"
                optionValue="value"
                class="w-32">
              </p-select>
            </div>
            <div class="flex flex-col">
              <label class="text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">Minutes</label>
              <p-select
                [options]="minutesList"
                formControlName="minutes"
                placeholder="Select Minutes"
                optionLabel="label"
                optionValue="value"
                class="w-32">
              </p-select>
            </div>
            <div class="flex flex-col">
              <label class="text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">Seconds</label>
              <p-select
                [options]="secondsList"
                formControlName="seconds"
                placeholder="Select Seconds"
                optionLabel="label"
                optionValue="value"
                class="w-32">
              </p-select>
            </div>
          </div>

          <p-divider></p-divider>

          <div class="form-row grid grid-cols-3 gap-4">
            <div class="form-group">
              <label for="threads">
                Threads
                <app-tooltip [text]="'Determines how many proxies are checked concurrently.'"></app-tooltip>
              </label>
              <input id="threads" formControlName="threads" type="number" pInputText class="w-full"/>
            </div>
            <div class="form-group">
              <label for="retries">Retries</label>
              <input id="retries" formControlName="retries" type="number" pInputText class="w-full"/>
            </div>
            <div class="form-group">
              <label for="timeout">Timeout (ms)</label>
              <input id="timeout" formControlName="timeout" type="number" pInputText class="w-full"/>
            </div>
          </div>

          <p-divider></p-divider>

          <div class="flex justify-center flex-wrap gap-6 mt-8 mb-3">
            <app-checkbox label="Dynamic Threads" formControlName="dynamic_threads"></app-checkbox>
            <app-checkbox label="Use HTTPS for SOCKS" formControlName="use_https_for_socks"></app-checkbox>
          </div>
        </p-tabpanel>

        <!-- Judges Tab -->
        <p-tabpanel value="1">
          <div class="form-row grid grid-cols-2 gap-4">
            <div class="form-group">
              <label for="judges_threads">Judge Threads</label>
              <input id="judges_threads" formControlName="judges_threads" type="number" pInputText class="w-full"/>
            </div>
            <div class="form-group">
              <label for="judges_timeout">Judge Timeout (ms)</label>
              <input id="judges_timeout" formControlName="judges_timeout" type="number" pInputText class="w-full"/>
            </div>
          </div>

          <p-divider></p-divider>

          <h4 class="text-center subText">
            Check Judges every
            <app-tooltip text="Refreshes the IP addresses of the judges if they've changed"></app-tooltip>
          </h4>

          <div class="flex justify-center gap-4 flex-wrap text-center mt-4" formGroupName="judge_timer">
            <div class="flex flex-col">
              <label class="text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">Days</label>
              <p-select
                [options]="daysList"
                formControlName="days"
                placeholder="Select Days"
                optionLabel="label"
                optionValue="value"
                class="w-32">
              </p-select>
            </div>
            <div class="flex flex-col">
              <label class="text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">Hours</label>
              <p-select
                [options]="hoursList"
                formControlName="hours"
                placeholder="Select Hours"
                optionLabel="label"
                optionValue="value"
                class="w-32">
              </p-select>
            </div>
            <div class="flex flex-col">
              <label class="text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">Minutes</label>
              <p-select
                [options]="minutesList"
                formControlName="minutes"
                placeholder="Select Minutes"
                optionLabel="label"
                optionValue="value"
                class="w-32">
              </p-select>
            </div>
            <div class="flex flex-col">
              <label class="text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">Seconds</label>
              <p-select
                [options]="secondsList"
                formControlName="seconds"
                placeholder="Select Seconds"
                optionLabel="label"
                optionValue="value"
                class="w-32">
              </p-select>
            </div>
          </div>

          <p-divider></p-divider>

          <div formArrayName="judges">
            <h4 class="text-center subText">Default Judge URLs and Regex</h4>
            @for (judge of judges.controls; track judge; let i = $index) {
              <div [formGroupName]="i" class="form-row grid grid-cols-2 gap-4">
                <div class="form-group">
                  <label for="judge-url-{{i}}">URL</label>
                  <input id="judge-url-{{i}}" formControlName="url" type="text" pInputText class="w-full"/>
                </div>
                <div class="form-group">
                  <label for="judge-regex-{{i}}">
                    Regex
                    <app-tooltip [text]="'If the regex is set to default...etc'"></app-tooltip>
                  </label>
                  <input id="judge-regex-{{i}}" formControlName="regex" type="text" pInputText class="w-full"/>
                </div>
                @if (judges.length > 1) {
                  <button type="button" class="btn-remove mt-2" (click)="removeJudge(i)">
                    <i class="pi pi-trash"></i>
                  </button>
                }
              </div>
            }
            <button type="button" class="btn-add" (click)="addJudge()">
              <i class="pi pi-plus"></i> Add Judge
            </button>
          </div>
        </p-tabpanel>

        <!-- IP and Blacklist Tabs -->
        <p-tabpanel value="2">
          <!-- Your IP content -->
        </p-tabpanel>
        <p-tabpanel value="3">
          <!-- Your Blacklist content -->
        </p-tabpanel>
      </p-tabpanels>
    </p-tabs>
  </form>
</div>

<div class="flex justify-center mt-4">
  <p-button
    type="submit"
    label="Save Settings"
    (onClick)="onSubmit()"
    [disabled]="!settingsForm.dirty"
    class="button-padding">
  </p-button>
</div>
