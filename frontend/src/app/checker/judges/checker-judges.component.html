<div class="checker-judges-page text-gray-200">
  <section class="judges-panel bg-neutral-900 border border-neutral-800 rounded-2xl p-6 shadow-lg">
    <header class="panel-header flex flex-col md:flex-row md:items-center md:justify-between gap-4">
      <div>
        <h2 class="text-xl font-semibold text-white mb-1">Judge Endpoints</h2>
        <p class="text-sm text-gray-400 max-w-2xl">
          Configure the endpoints the checker will call and optionally fine-tune the validation with a custom regex.
          These judges help determine whether proxies are alive, anonymous and returning the expected payload.
        </p>
      </div>
      <button type="button" class="add-judge-button" (click)="addJudge()">
        <i class="pi pi-plus"></i>
        Add Judge
      </button>
    </header>

    <div class="judge-list flex flex-col gap-4">
      @for (judge of judgeControls; track judge; let i = $index) {
        <article [formGroup]="judge"
                 class="judge-card bg-neutral-950/40 border border-neutral-800 rounded-xl p-5">
          <div class="card-header flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4">
            <div>
              <div class="judge-chip">Judge {{ i + 1 }}</div>
              <p class="text-xs text-gray-400 mt-2">
                Define the endpoint to call and how to confirm the response is valid for this judge.
              </p>
            </div>
            <button
              type="button"
              class="icon-button"
              (click)="removeJudge(i)"
              [attr.aria-label]="'Remove judge #' + (i + 1)"
            >
              <i class="pi pi-trash"></i>
            </button>
          </div>

          <div class="card-body grid grid-cols-1 lg:grid-cols-2 gap-4 mt-4">
            <div class="field-group">
              <label class="field-label" for="judge-url-{{ i }}">Judge URL</label>
              <input
                id="judge-url-{{ i }}"
                formControlName="url"
                type="text"
                pInputText
                class="p-inputtext-sm w-full"
                placeholder="https://example.com/judge"
              />
              <p class="field-hint">Should return headers or other data that verifies the proxy connection.</p>
            </div>

            <div class="field-group">
              <label class="field-label" for="judge-regex-{{ i }}">
                Custom Regex
                <app-tooltip
                  [text]="'If the regex is set to default, the program validates the response using headers to detect anonymity. Provide your own regex to match specific content in the judge response.'"
                ></app-tooltip>
              </label>
              <input
                id="judge-regex-{{ i }}"
                formControlName="regex"
                type="text"
                pInputText
                class="p-inputtext-sm w-full"
                placeholder="default"
              />
              <p class="field-hint">Leave as <code>default</code> to rely on header-based validation.</p>
            </div>
          </div>
        </article>
      }
    </div>

    <footer class="panel-footer flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between mt-6">
      <p class="text-xs text-gray-500 max-w-xl">
        Settings will be saved and applied to new checker sessions.
      </p>
      <p-button
        type="button"
        label="Save Judges"
        (onClick)="onSubmit()"
        [disabled]="!judgesForm.dirty"
        styleClass="save-judges-button"
      >
      </p-button>
    </footer>
  </section>
</div>
