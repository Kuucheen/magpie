@if (dashboardInfo().loading && !dashboardInfo().loaded) {
  <div class="dashboard-container">
    <div class="flex flex-wrap -m-2 dashboard-skeleton">
      @for (card of kpiSkeletons; track $index) {
        <div class="w-full md:w-1/3 p-2">
          <div class="dashboard-skeleton-card">
            <p-skeleton width="6rem" height="0.9rem"></p-skeleton>
            <p-skeleton width="5rem" height="1.75rem" class="mt-3"></p-skeleton>
            <p-skeleton width="100%" height="2.75rem" class="mt-4"></p-skeleton>
          </div>
        </div>
      }
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mt-4 dashboard-skeleton">
      <div class="lg:col-span-2">
        <div class="dashboard-skeleton-card">
          <p-skeleton width="10rem" height="1rem"></p-skeleton>
          <p-skeleton width="100%" height="14rem" class="mt-4"></p-skeleton>
        </div>
      </div>

      <div class="lg:col-span-1">
        <div class="dashboard-skeleton-card">
          <p-skeleton width="8rem" height="1rem"></p-skeleton>
          <div class="dashboard-skeleton-list mt-4">
            @for (row of historySkeletons; track $index) {
              <p-skeleton width="100%" height="0.85rem"></p-skeleton>
            }
          </div>
        </div>
      </div>

      <div class="lg:col-span-2">
        <div class="dashboard-skeleton-card">
          <p-skeleton width="9rem" height="1rem"></p-skeleton>
          <p-skeleton width="100%" height="10rem" class="mt-4"></p-skeleton>
        </div>
      </div>

      <div class="lg:col-span-1">
        <div class="dashboard-skeleton-card">
          <p-skeleton width="10rem" height="1rem"></p-skeleton>
          <div class="dashboard-skeleton-list mt-4">
            @for (row of countrySkeletons; track $index) {
              <p-skeleton width="100%" height="0.85rem"></p-skeleton>
            }
          </div>
        </div>
      </div>

      <div class="lg:col-span-2">
        <div class="dashboard-skeleton-card">
          <p-skeleton width="12rem" height="1rem"></p-skeleton>
          <div class="dashboard-skeleton-reputation mt-4">
            <p-skeleton width="45%" height="12rem"></p-skeleton>
            <div class="dashboard-skeleton-list flex-1">
              @for (row of reputationSkeletons; track $index) {
                <p-skeleton width="90%" height="0.85rem"></p-skeleton>
              }
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
}

@if (dashboardInfo().error) {
  <div class="mt-4 text-center text-red-400">
    {{ dashboardInfo().error }}
  </div>
}

@if (dashboardInfo().loaded) {
  <div class="dashboard-container">
    <div class="flex flex-wrap -m-2">
      <div class="w-full md:w-1/3 p-2">
        <app-kpi-card
          title="Alive Proxies"
          [value]="conversionRate().value"
          [displayValue]="conversionRate().value | number"
          [chartValues]="conversionRate().history">
        </app-kpi-card>
      </div>

      <div class="w-full md:w-1/3 p-2">
        <app-kpi-card
          title="Total Proxies"
          [value]="avgOrderValue().value"
          [displayValue]="avgOrderValue().value | number"
          [chartValues]="avgOrderValue().history">
        </app-kpi-card>
      </div>

      <div class="w-full md:w-1/3 p-2">
        <app-kpi-card
          title="Scraped Proxies"
          [value]="orderQuantity().value"
          [displayValue]="orderQuantity().value | number"
          [chartValues]="orderQuantity().history">
        </app-kpi-card>
      </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mt-4">
      <div class="lg:col-span-2">
        <app-proxies-per-hour-card
          [chartData]="proxiesLineData()"
          [chartOptions]="proxiesLineOptions()">
        </app-proxies-per-hour-card>
      </div>

      <div class="lg:col-span-1">
        <app-proxy-history-card
          [history]="proxyHistory()"
          [refreshing]="proxyHistoryRefreshing()"
          (refresh)="onProxyHistoryRefresh()">
        </app-proxy-history-card>
      </div>

      <div class="lg:col-span-2">
        <app-proxies-per-country-card
          [countries]="majorCountries()">
        </app-proxies-per-country-card>
      </div>

      <div class="lg:col-span-1">
        <app-judge-by-percentage-card
          [data]="judgeTrafficData()"
          [periodOptions]="judgePeriodOptions">
        </app-judge-by-percentage-card>
      </div>

      <div class="lg:col-span-2">
        <app-proxy-reputation-card
          [breakdown]="reputationBreakdown()"
          [chartData]="reputationChartData()"
          [chartOptions]="reputationChartOptions()">
        </app-proxy-reputation-card>
      </div>

  <!--    @if (anonymitySummary()) {-->
  <!--      <div class="lg:col-span-1">-->
  <!--        <app-proxies-by-anonymity-card-->
  <!--          [summary]="anonymitySummary()"-->
  <!--          [segments]="anonymitySegments()">-->
  <!--        </app-proxies-by-anonymity-card>-->
  <!--      </div>-->
  <!--    }-->


    </div>
  </div>
}
