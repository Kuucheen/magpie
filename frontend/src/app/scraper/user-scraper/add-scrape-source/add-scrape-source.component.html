<div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
  <!-- Header -->
  <div class="text-center mb-6">
    <h4 class="text-lg font-medium text-gray-700 dark:text-gray-300 flex items-center justify-center gap-2">
      Add Scrape Sources
      <i class="pi pi-info-circle text-gray-400 cursor-help"
         pTooltip="A scrape source is a website that shows proxies on it."
         tooltipPosition="top">
      </i>
    </h4>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- Left Column - Input Methods -->
    <div class="space-y-4">
      <!-- Clipboard Section -->
      <div class="flex gap-2">
        <div class="flex-1">
          <p-button
            label="Paste from Clipboard"
            icon="pi pi-clipboard"
            (onClick)="pasteFromClipboard()"
            [disabled]="clipboardScrapeSources"
            [outlined]="clipboardScrapeSources"
            severity="primary"
            class="w-full">
          </p-button>
        </div>
        @if (clipboardScrapeSources) {
          <p-button
            icon="pi pi-times"
            (onClick)="clearClipboardSources()"
            severity="danger"
            [text]="true"
            class="flex-shrink-0">
          </p-button>
        }
      </div>

      <!-- File Upload Section -->
      <div class="flex gap-2">
        <div class="flex-1">
          <p-button
            label="Import from File"
            icon="pi pi-upload"
            (onClick)="triggerFileInput(fileInput)"
            [disabled]="file != undefined"
            [outlined]="file != undefined"
            severity="primary"
            class="w-full">
          </p-button>
          <input
            type="file"
            #fileInput
            (change)="onFileSelected($event)"
            class="hidden"
            accept=".txt,.csv">
        </div>
        @if (file != undefined) {
          <p-button
            icon="pi pi-times"
            (onClick)="onFileClear()"
            severity="danger"
            [text]="true"
            class="flex-shrink-0">
          </p-button>
        }
      </div>

      <!-- Textarea Section -->
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
          Bulk Add Scrape Sources
        </label>
        <textarea
          pTextarea
          [(ngModel)]="scrapeSourceTextarea"
          (ngModelChange)="addTextAreaSources()"
          maxlength="109999"
          placeholder="Bulk add Scrape Sources&#10;https://scrape-source.com"
          rows="8"
          class="w-full resize-none">
        </textarea>
      </div>
    </div>

    <!-- Right Column - Stats/Icon -->
    <div class="flex items-center justify-center">
      @if (getSourcesCount() > 0) {
        <div class="text-center bg-blue-50 dark:bg-blue-900/20 p-6 rounded-lg border border-blue-200 dark:border-blue-800">
          <div class="text-2xl font-bold text-blue-600 dark:text-blue-400 mb-2">
            {{ getSourcesCount() }}
          </div>
          <div class="text-sm text-gray-600 dark:text-gray-400 mb-1">
            Total Scrape Sources
          </div>
          <div class="text-lg font-semibold text-green-600 dark:text-green-400">
            {{ getUniqueSourcesCount() }}
          </div>
          <div class="text-sm text-gray-600 dark:text-gray-400">
            Unique Sources
          </div>
        </div>
      } @else {
        <div class="text-gray-400 dark:text-gray-500">
          <i class="pi pi-chart-line text-6xl"></i>
        </div>
      }
    </div>
  </div>
</div>

<!-- Action Buttons -->
<div class="flex flex-col sm:flex-row items-center justify-center gap-4 mt-6">
  <div class="w-full sm:w-auto">
    <p-button
      label="Add Scrape Sources to Queue"
      icon="pi pi-plus"
      (onClick)="submitScrapeSources()"
      severity="success"
      size="large"
      class="w-full sm:w-auto min-w-64">
    </p-button>
  </div>

  <div class="flex items-center gap-3">
    <p-checkbox
      inputId="high-priority"
      [binary]="true">
    </p-checkbox>
    <label for="high-priority"
           class="text-sm font-medium text-gray-700 dark:text-gray-300 cursor-pointer flex items-center gap-2">
      High Priority Queue
      <i class="pi pi-info-circle text-gray-400 cursor-help"
         pTooltip="When High Priority Queue is activated, scrape sources will get checked instantly and will NOT be at the end of the queue."
         tooltipPosition="top">
      </i>
    </label>
  </div>
</div>

<!-- Processing Popup -->
@if (showPopup) {
  <app-procesing-popup
    [status]="popupStatus"
    [count]="addedSourceCount"
    [item]="'Scrape Sources'"
    (closed)="onPopupClose()">
  </app-procesing-popup>
}
